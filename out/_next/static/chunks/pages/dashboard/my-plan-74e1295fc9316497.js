(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9760],{21343:function(a,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/my-plan",function(){return n(93521)}])},93521:function(a,t,n){"use strict";n.r(t),n.d(t,{default:function(){return y}});var e=n(85893),l=n(90948),o=n(5616),i=n(15861),s=n(90629),r=n(67294),u=n(87066),d=n(49802),c=n(11163),p=n(28092);n(65654);var m=n(30381),h=n.n(m),x=n(6566);n(31022);var f=n(51415),v=n(68611);n(34899);let g=(0,l.ZP)("div")(a=>{let{theme:t}=a;return{"& subscribtionBox":{position:"relative",zIndex:"999","& .MuiIconButton-root":{padding:"0px"},"& .typoBox":{padding:"10px 0px 30px"},"& .invitebutton":{marginRight:"-13px",padding:"24px 39px"},"& .paperBox":{padding:"80px 30px",boredrRadius:"5px"},"& .invitelistBox":{padding:"30px 0px 10px",display:"flex",justifyContent:"space-between",textAlign:"center"},"& .tablepadding":{margin:"50px 0px 20px",[t.breakpoints.down("xs")]:{margin:"20px 0px"}}},"& .tableBox":{minWidth:"800px"},"& .rowEven":{background:"rgb(16 21 17)"}}}),S=[{heading:"Sr. No"},{heading:"Plan Name"},{heading:"Plan Amount"},{heading:"Paid Amount"},{heading:"Plan Status"},{heading:"Start Time"},{heading:"End Time"},{heading:"Txn Hash",isCopy:!0}];function y(){let a=(0,r.useContext)(v.Z),[t,n]=(0,r.useState)(1),[l,d]=(0,r.useState)([]);(0,c.useRouter)();let[m,y]=(0,r.useState)(1),[D,T]=(0,r.useState)([]),[P,b]=(0,r.useState)(!1),[_,N]=(0,r.useState)(!1),[Y,w]=(0,r.useState)(!0),[E,Z]=(0,r.useState)({fromDate:null,toDate:null,search:"",planStatus:"1"}),A=async a=>{try{N(!1),b(!0);let o=await (0,p.nO)({endPoint:"myPlan",paramsData:{search:(null==E?void 0:E.search)?null==E?void 0:E.search:null,page:t,limit:10,planStatus:(null==E?void 0:E.planStatus)!=="1"?null==E?void 0:E.planStatus:null,fromDate:E.fromDate?h()(E.fromDate).format("YYYY-MM-DD"):null,toDate:E.toDate?h()(E.toDate).format("YYYY-MM-DD"):null},source:a});if(200===o.data.responseCode){var n,e,l;N(!1);let a=null===(n=o.data.result.docs)||void 0===n?void 0:n.map(a=>({planName:a.planName,planAmount:a.planAmount,amount:a.amount,pay_currency:a.pay_currency,planStatus:a.planStatus,startTime:a.startTime,endTime:a.endTime,transactionHash:a.transactionHash}));d(a),y(null===(e=o.data.result)||void 0===e?void 0:e.pages),T(null===(l=o.data.result)||void 0===l?void 0:l.docs),b(!1)}b(!1)}catch(a){T([]),y(1),b(!1)}},C=async a=>{try{let e=await (0,u.Z)({method:"POST",url:api_configs[a],headers:{token:token},data:{search:(null==E?void 0:E.search)?null==E?void 0:E.search:void 0,page:"1",limit:total.toString(),planStatus:(null==E?void 0:E.planStatus)!=="1"?null==E?void 0:E.planStatus:null,fromDate:E.fromDate?h()(E.fromDate).format("YYYY-MM-DD"):null,toDate:E.toDate?h()(E.toDate).format("YYYY-MM-DD"):null}});if(200===e.data.responseCode){var t;let a=[];for(var n=0;n<(null===(t=e.data.result.docs)||void 0===t?void 0:t.length);n++){let t=e.data.result.docs[n],l=t.planName,o=t.planAmount,i=t.amount,s=t.pay_currency,r=t.planStatus,u=t.startTime,d=t.endTime,c=data.transactionHash,p={"Plan Name":l,"Plan Amount":o,"Paid Amount":i,"Pay Currency":s,"Plan Status":r,"Start Time":h()(u).format("lll"),"End Time":h()(d).format("lll"),"Txn Hash":c};a.push(p)}exportToCSV(a,"myPlans")}b(!1)}catch(a){console.log(a),b(!1)}};return(0,r.useEffect)(()=>{let a=u.Z.CancelToken.source();return A(a,t),()=>{a.cancel()}},[t]),(0,r.useEffect)(()=>{if(_){let a=u.Z.CancelToken.source();return A("",t),()=>{a.cancel()}}},[_]),(0,r.useEffect)(()=>{null==a||a.setTopHeading((0,e.jsxs)(o.Z,{display:"flex",alignItems:"center",children:[(0,e.jsx)("img",{src:"/images/arbi_text.svg",width:"24px",height:"24px",style:{marginRight:"6px"}}),(0,e.jsx)(i.Z,{variant:"h3",color:"primary",style:{whiteSpace:"pre"},children:"My Plan's"})]}))},[]),(0,e.jsx)(g,{children:(0,e.jsxs)(o.Z,{className:"subscribtionBox",children:[(0,e.jsx)(o.Z,{mb:3,children:(0,e.jsx)(s.Z,{elevation:2,children:(0,e.jsx)(x.Z,{filter:E,setFilter:a=>{Z(a),w(!1)},clearFilters:()=>{Y||(Z({...E,fromDate:null,toDate:null,search:"",planStatus:"1"}),n(1),N(!0),w(!0))},onClickFun:()=>{A("",1),w(!1)},userData:l,placeholder:"Search by plan name",type:"transactionMgmt",fileNames:"my_plans",handleExport:()=>C()})})}),(0,e.jsx)(f.Z,{tableHead:S,scoreListData:D&&D.map((a,n)=>({"Sr. No":(t-1)*10+n+1,"Plan Name":(null==a?void 0:a.planName)?null==a?void 0:a.planName:"","Plan Amount":(null==a?void 0:a.planAmount)?"".concat(null==a?void 0:a.planAmount," ").concat(null==a?void 0:a.pay_currency):"","Paid Amount":(null==a?void 0:a.amount)?"".concat(null==a?void 0:a.amount," ").concat(null==a?void 0:a.pay_currency):"","Plan Status":(null==a?void 0:a.planStatus)?null==a?void 0:a.planStatus:"-","Start Time":h()(null==a?void 0:a.startTime).format("lll"),"End Time":h()(null==a?void 0:a.endTime).format("lll"),"Txn Hash":(null==a?void 0:a.transactionHash)?null==a?void 0:a.transactionHash:"-"})),noOfPages:m,noOfTotalPages:m,page:t,setPage:n,limit:10,isLoading:P,NoDataFoundText:"No subscription purchased"})]})})}y.getLayout=function(a){return(0,e.jsx)(d.Z,{children:a})}}},function(a){a.O(0,[2251,1228,9570,9866,8907,6158,9401,7237,4885,4152,9990,3547,9043,5543,2781,3575,6886,3362,2e3,2213,9398,1664,213,4819,1535,1595,2739,9886,1415,6642,2888,9774,179],function(){return a(a.s=21343)}),_N_E=a.O()}]);